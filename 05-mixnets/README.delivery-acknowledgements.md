# Подтверждение доставки

### Как включить подтверждение доставки
После стандартного запуска программы, нужно в командную строку передать команду enableAck, она установит флаг и после этого все сообщения будут отправляться с подтверждением доставки. Если этот режим нужно выключить, то введите команду disableAck

### Формат сообщения
Для нашего сообщения мы используем буквы C и c.
Дополнительно в сообщение мы передаем:
* Номер сообщения - 4 байта
* Номер подтверждения - 4 байта
* Id сессии - guid 32 байта
* Размер окна - 4 байта
* Собственный адрес, возведенный в хэш определенное количество раз - 32 байта

## Как работает наше решение
Мы создали сущность - журнал подтверждения. В нем хранится информация об отправленных и полученных сообщениях.
У каждой записи в журнале есть ID - GUID.
Записи в  журнале бывают 2 типов - запись для отправленных сообщений (JournalSentRecord) и запись для принятых сообщений (JournalRecvRecord)

Какая информация храниться в JournalSentRecord:
* Указатель на последнюю отправленную часть сообщения
* Указатель на последнюю подтвержденную часть сообщения
* Размер окна
* Массив из пар (кусок информации для отправки, номер этого куска)

Какая информация храниться в JournalRecvRecord:
* Размер окна
* Массив из пар (кусок информации для отправки, номер этого куска)
* Таймер

Когда пользователь хочет отправить сообщение, мы создаем запись в журнале и разбиваем сообщение на части фиксированной длины.
Потом мы отправляем несколько частей сообщения, в зависимости от размера окна. После какого-то времени мы либо отправляем те же части повторно, либо отправляем новые части.

###PS
Почему мы записываем GUID в сообщение - мы считаем, что отправитель не хочет чтобы получатель знал его адрес. Поэтому мы создали идентификатор для сессии, чтобы получатель мог понять к какой сессии относятся  полученные им сообщения


